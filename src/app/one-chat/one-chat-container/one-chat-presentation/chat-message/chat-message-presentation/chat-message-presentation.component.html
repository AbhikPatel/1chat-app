<!-- Start: User Message  -->
<div class="h-100 d-flex flex-column overflow-hidden">
    <!-- Start: Header Section  -->
    <div id="header" class="d-flex align-items-center justify-content-between px-5">
        <div class="d-flex align-items-center">
            <figure class="m-0" *ngIf="getReceiverData.photo">
                <img [src]="convertPhoto(getReceiverData?.photo)" class="rounded-circle profile-img" alt="profile">
            </figure>
            <div class="ms-3 d-flex flex-column">
                <span class="fw-semibold"> {{getReceiverData?.full_name}} </span>
                <span [ngClass]="(showTyping | async) ? 'visible' : 'invisible'" class="fs-8"> Typing... </span>
            </div>
        </div>
        <div class="fs-4" role="button" (click)="onLogOut()" title="logout">
            <i class='icon-bx-log-out  text-info'></i>
        </div>
    </div>
    <!-- End: Header Section  -->

    <!-- Start: Chat Screen  -->
    <div class="chat-container flex-grow-1 overflow-auto px-5 py-4 " #scroll appScrollDistance >
        <!-- Chat  -->
        <div class="d-flex" *ngFor="let data of getChat"
            [ngClass]="data.sender === senderId ? 'justify-content-end' : 'justify-content-start'" >
            <div class="chat" >

                <!-- Sender Name  -->
                <p class="mb-1 fs-7" [ngClass]="data.sender === senderId ? 'text-end' : 'text-start'">
                    <span class="text-info"> {{data.sender === senderId ? 'You' : getReceiverData?.full_name}} </span>
                </p>

                <!-- Chat Message  -->
                <div class="d-flex"
                    [ngClass]="data.sender === senderId ? 'justify-content-end' : 'justify-content-start'">
                    <p class="chat-text rounded-3 py-1 px-2 border mb-1"
                        [ngClass]="data.sender === senderId ? 'bg-secondary' : 'bg-white'">
                        {{data.content.text}}
                    </p>
                </div>

                <!-- Time and Date  -->
                <p class="fs-8 text-info d-flex align-items-center" [ngClass]="data.sender === senderId ? 'justify-content-end' : 'justify-content-start'">
                    <span class="pe-1">
                        {{data.convertedTime}}
                    </span>
                    <ng-container *ngIf="data.sender === senderId">
                        <span *ngIf="!data.is_read">
                            <img src="https://img.icons8.com/ios-filled/16/b1b1b1/double-tick.png"/>
                        </span>
                        <span *ngIf="data.is_read">
                            <img src="https://img.icons8.com/ios-filled/16/00ffff/double-tick.png"/>
                        </span>
                    </ng-container>
                </p>
            </div>
        </div>
        <div class="icon-circle-down fs-4 text-info position-fixed end-0 me-4 position-relative" id="icon" (click)="scrollUp()" > 
            <span class="count-message position-absolute   badge rounded-pill bg-secondary  fs-9 text-black">1</span>
        </div>
    </div>
    <!-- End: Chat Screen  -->

    <!-- Start: Message  -->
    <div id="typer" class="d-flex align-items-center bg-theme px-5 pt-0">
        <form class="w-100  d-flex flex-column " (ngSubmit)="onSubmit()" [formGroup]="chatGroup">
            <input type="text" class="form-control py-2 rounded-1 " name="message" id="message" formControlName="message"
                autocomplete="off" placeholder="Type a new message" >
                <div class="d-flex align-items-center justify-content-between px-1 py-1">
                    <div class="file-attach">
                        <label for="file" >
                            <i class="icon-paperclip fs-5 text-info cursor-pointer " id="icon"></i>
                        </label>
                        <i id="icon" class="icon-emoji-smile fs-5 ms-2 text-info cursor-pointer"></i>
                    </div>
                    <button class="fs-4 border-0 ms-3 bg-transparent" type="submit">
                           <i class='icon-bxs-send text-info'  id="icon" ></i>
                    </button>
                </div>
                 <input type="file" id="file" class="d-none">
        </form>
    </div>
    <!-- End: Message  -->
</div>
<!-- End: User Message  -->